keymanager: Add support for master secret generations

Refactored key manager's init method to be able to support multiple
generations of the master secret.
